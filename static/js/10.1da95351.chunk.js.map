{"version":3,"sources":["components/Uploader.js","components/Tips.js","pages/Home.js"],"names":["Dragger","Upload","Result","styled","div","H1","h1","Image","img","Component","observer","useStores","ImageStore","UserStore","ref1","useRef","ref2","store","useLocalStore","width","setWidth","height","setHeight","serverFile","attributes","url","widthStr","heightStr","props","showUploadList","beforeUpload","file","setFile","setFilename","name","currentUser","message","warning","window","test","type","size","error","upload","then","console","log","catch","tip","spinning","isUpoading","className","InboxOutlined","target","href","filename","src","ref","onChange","current","value","placeholder","fullStr","Tips","children","Home","Uploader"],"mappings":"8jBAOQA,EAAYC,IAAZD,QAGFE,EAASC,IAAOC,IAAV,KAKNC,EAAKF,IAAOG,GAAV,KAIFC,EAAQJ,IAAOK,IAAV,KAgHIC,EA1GGC,aAAS,WAAO,IAAD,EACGC,cAA1BC,EADuB,EACvBA,WAAYC,EADW,EACXA,UACdC,EAAOC,mBACPC,EAAOD,mBAEPE,EAAQC,aAAc,iBAAO,CACjCC,MAAO,KACPC,SAFiC,SAExBD,GACPF,EAAME,MAAQA,GAEhB,eACE,OAAOF,EAAME,MAAN,aAAoBF,EAAME,OAAU,IAE7CE,OAAQ,KACRC,UATiC,SASvBD,GACRJ,EAAMI,OAASA,GAEjB,gBACE,OAAOJ,EAAMI,OAAN,aAAqBJ,EAAMI,QAAW,IAE/C,cAEE,OAAOT,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,IAAM,gBAAkBR,EAAMS,SAAWT,EAAMU,eAepGC,EAAQ,CACZC,gBAAgB,EAChBC,aAAc,SAAAC,GAGZ,OAFAnB,EAAWoB,QAAQD,GACnBnB,EAAWqB,YAAYF,EAAKG,MACE,OAA1BrB,EAAUsB,aACZC,IAAQC,QAAQ,qDACT,IAETC,OAAOP,KAAOA,EACT,wCAAwCQ,KAAKR,EAAKS,MAInDT,EAAKU,KAAO,SACdL,IAAQM,MAAM,+BACP,IAGT9B,EAAW+B,SACRC,MAAK,SAACrB,GACLsB,QAAQC,IAAI,4BACZD,QAAQC,IAAIvB,MACXwB,OAAM,WACPF,QAAQC,IAAI,gCAET,IAfLV,IAAQM,MAAM,0EACP,MAkBb,OACE,6BACE,kBAAC,IAAD,CAAMM,IAAI,qBAAMC,SAAUrC,EAAWsC,YACnC,kBAAClD,EAAY4B,EACX,uBAAGuB,UAAU,wBACX,kBAACC,EAAA,EAAD,OAEF,uBAAGD,UAAU,mBAAb,gEACA,uBAAGA,UAAU,mBAAb,yGAMFvC,EAAWW,WAAa,kBAACrB,EAAD,KACtB,kBAACG,EAAD,iCACA,4BACE,wDACA,4BAAI,uBAAGgD,OAAO,SAASC,KAAM1C,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,KAAMb,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,MACnI,kDACA,4BAAKb,EAAW2C,UAChB,wDACA,4BACE,kBAAChD,EAAD,CAAOiD,IAAK5C,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,OAE9D,wDACA,4BACE,2BAAOgC,IAAK3C,EAAM4C,SAnEN,WACtBb,QAAQC,IAAI,sBACZD,QAAQC,IAAIhC,EAAK6C,QAAQC,OACzB3C,EAAMG,SAASN,EAAK6C,QAAQC,QAgE2BC,YAAY,qDACzD,2BAAOJ,IAAKzC,EAAM0C,SA9DL,WACvBzC,EAAMK,UAAUN,EAAK2C,QAAQC,QA6D2BC,YAAY,sDAE5D,4BACE,uBAAGR,OAAO,SAASC,KAAMrC,EAAM6C,SAAU7C,EAAM6C,YAGzC,S,0KCzHpB,IAAMC,EAAO5D,IAAOC,IAAV,KAmBKK,EAXGC,aAAS,YAAmB,IAAhBsD,EAAe,EAAfA,SACpBnD,EAAcF,cAAdE,UACR,OACE,oCAEIA,EAAUsB,YAAc,KAAO,kBAAC4B,EAAD,KAAOC,OCZxCC,EAAOvD,aAAS,WACEC,cAAdE,UAIR,OACE,oCACI,kBAAC,EAAD,sDAEF,kBAACqD,EAAD,UAKSD","file":"static/js/10.1da95351.chunk.js","sourcesContent":["import React, { useRef } from 'react';\nimport { useStores } from '../stores';\nimport { observer, useLocalStore } from 'mobx-react';\nimport { Upload, message, Spin } from 'antd';\nimport { InboxOutlined } from '@ant-design/icons';\nimport styled from 'styled-components';\n\nconst { Dragger } = Upload;\n\n\nconst Result = styled.div`\n  margin-top: 30px;\n  border: 1px dashed #ccc;\n  padding: 20px;\n`;\nconst H1 = styled.h1`\n  margin: 20px 0;\n  text-align: center;\n`;\nconst Image = styled.img`\n  max-width: 300px;\n`;\n\n\n\nconst Component = observer(() => {\n  const { ImageStore, UserStore } = useStores();\n  const ref1 = useRef();\n  const ref2 = useRef();\n\n  const store = useLocalStore(() => ({\n    width: null,\n    setWidth(width) {\n      store.width = width;\n    },\n    get widthStr() {\n      return store.width ? `/w/${store.width}` : '';\n    },\n    height: null,\n    setHeight(height) {\n      store.height = height;\n    },\n    get heightStr() {\n      return store.height ? `/h/${store.height}` : '';\n    },\n    get fullStr() {\n      //?imageView2/0/w/800/h/400)\n      return ImageStore.serverFile.attributes.url.attributes.url + '?imageView2/0' + store.widthStr + store.heightStr\n    }\n\n  }));\n\n  const bindWidthChange = () => {\n    console.log('bindWidthChange...')\n    console.log(ref1.current.value)\n    store.setWidth(ref1.current.value);\n  };\n\n  const bindHeightChange = () => {\n    store.setHeight(ref2.current.value);\n  };\n\n  const props = {\n    showUploadList: false,\n    beforeUpload: file => {\n      ImageStore.setFile(file);\n      ImageStore.setFilename(file.name);\n      if (UserStore.currentUser === null) {\n        message.warning('请先登录再上传！');\n        return false;\n      }\n      window.file = file\n      if (!/(svg$)|(png$)|(jpg$)|(jpeg$)|(gif$)/ig.test(file.type)) {\n        message.error('只能上传png/svg/jpg/gif格式的图片');\n        return false;\n      }\n      if (file.size > 1024 * 1024) {\n        message.error('图片最大1M');\n        return false;\n      }\n\n      ImageStore.upload()\n        .then((serverFile) => {\n          console.log('上传成功')\n          console.log(serverFile);\n        }).catch(() => {\n          console.log('上传失败')\n        });\n      return false;\n    }\n  };\n\n  return (\n    <div>\n      <Spin tip=\"上传中\" spinning={ImageStore.isUpoading}>\n        <Dragger {...props}>\n          <p className=\"ant-upload-drag-icon\">\n            <InboxOutlined />\n          </p>\n          <p className=\"ant-upload-text\">点击或者拖拽上传图片</p>\n          <p className=\"ant-upload-hint\">\n            仅支持.png/.gif/.jpg/.svg格式的图片，图片最大1M\n    </p>\n        </Dragger>\n      </Spin>\n      {\n        ImageStore.serverFile ? <Result>\n          <H1>上传结果</H1>\n          <dl>\n            <dt>线上地址</dt>\n            <dd><a target=\"_blank\" href={ImageStore.serverFile.attributes.url.attributes.url}>{ImageStore.serverFile.attributes.url.attributes.url}</a></dd>\n            <dt>文件名</dt>\n            <dd>{ImageStore.filename}</dd>\n            <dt>图片预览</dt>\n            <dd>\n              <Image src={ImageStore.serverFile.attributes.url.attributes.url} />\n            </dd>\n            <dt>更多尺寸</dt>\n            <dd>\n              <input ref={ref1} onChange={bindWidthChange} placeholder=\"最大宽度（可选）\" />\n              <input ref={ref2} onChange={bindHeightChange} placeholder=\"最大高度（可选）\" />\n            </dd>\n            <dd>\n              <a target=\"_blank\" href={store.fullStr}>{store.fullStr}</a>\n            </dd>\n          </dl>\n        </Result> : null\n      }\n    </div>\n  );\n});\nexport default Component;","import React from 'react';\nimport { useStores } from '../stores';\nimport { observer } from 'mobx-react';\nimport styled from 'styled-components';\n\nconst Tips = styled.div`\n  background: orange;\n  padding: 10px;\n  margin: 30px 0;\n  color: #fff;\n  border-radius: 4px;\n`;\n\nconst Component = observer(({ children }) => {\n  const { UserStore } = useStores();\n  return (\n    <>\n      {\n        UserStore.currentUser ? null : <Tips>{children}</Tips>\n      }\n    </>\n  );\n});\n\nexport default Component;","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { useStores } from '../stores';\nimport Uploader from '../components/Uploader';\nimport Tips from '../components/Tips';\n\nconst Home = observer(() => {\n  const { UserStore } = useStores();\n\n  const User = () => <div>Hello {UserStore.currentUser.attribures.username} </div>\n\n  return (\n    <>\n        <Tips>请先登录再上传!!!</Tips>\n      \n      <Uploader />\n    </>\n  );\n});\n\nexport default Home;"],"sourceRoot":""}